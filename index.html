<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guia Interativo - IN 08/2025 | DER-DF</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Slate & Amber -->
    <!-- Application Structure Plan: A single-page dashboard with a sticky top navigation bar for quick access to thematic sections (Vis√£o Geral, Regras Essenciais, Ve√≠culos, Condutor, Processos). This structure is task-oriented, allowing users to quickly find specific information (e.g., prohibitions, authorization steps) rather than navigating a linear slide deck. Interactive elements like tabs for vehicle categories and toggles for duties/prohibitions reduce cognitive load and improve usability. The new "Scenario Assistant" section uses the Gemini API to provide personalized guidance based on the document's content, further enhancing the app's utility as a practical reference tool. -->
    <!-- Visualization & Content Choices:
        - Fuel Quotas: Report Info -> Compare quotas. Goal -> Inform. Viz/Method -> Horizontal Bar Chart (Chart.js). Interaction -> Tooltips. Justification -> Faster comprehension than text.
        - Authorization Process: Report Info -> 5 steps to get authorized. Goal -> Instruct. Viz/Method -> HTML/CSS vertical step-flow diagram. Interaction -> Hover effects. Justification -> More intuitive than a simple list for a process.
        - Duties vs. Prohibitions: Report Info -> Lists of allowed/disallowed actions. Goal -> Compare/Inform. Viz/Method -> Two-column toggleable lists with icons. Interaction -> Click to show/hide lists. Justification -> Reduces information overload and provides focused answers.
        - Vehicle Categories: Report Info -> Rules for 3 vehicle types. Goal -> Organize/Compare. Viz/Method -> Tabbed interface. Interaction -> Click to switch content. Justification -> Hides irrelevant information, allowing users to focus on their specific vehicle type.
        - Disposal Criteria: Report Info -> Km and age limits. Goal -> Inform. Viz/Method -> Styled info cards. Interaction -> None. Justification -> Highlights key numbers for quick reference.
        - Scenario Assistant: Report Info -> All rules and guidelines. Goal -> Provide contextualized advice. Viz/Method -> Text input and output with LLM (Gemini API). Interaction -> User types scenario, clicks button, receives text response. Justification -> Aims to answer complex, real-world questions that aren't explicitly addressed in a simple list or chart.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .text-justify {
            text-align: justify;
        }
        .link-to-section {
            display: inline-block;
            background-color: #f59e0b; /* amber-500 */
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            font-weight: 500;
            text-decoration: none;
            transition: background-color 0.2s;
            margin-top: 1rem;
        }
        .link-to-section:hover {
            background-color: #d97706; /* amber-600 */
        }
    </style>
</head>
<body class="text-slate-800">

    <header class="bg-white shadow-md sticky top-0 z-50">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex-shrink-0">
                    <h1 class="text-lg font-bold text-slate-900">IN N¬∫ 08/2025 | DER-DF</h1>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#visao-geral" class="text-slate-600 hover:bg-slate-100 hover:text-slate-900 px-3 py-2 rounded-md text-sm font-medium">Vis√£o Geral</a>
                        <a href="#regras-essenciais" class="text-slate-600 hover:bg-slate-100 hover:text-slate-900 px-3 py-2 rounded-md text-sm font-medium">Regras Essenciais</a>
                        <a href="#veiculos" class="text-slate-600 hover:bg-slate-100 hover:text-slate-900 px-3 py-2 rounded-md text-sm font-medium">Ve√≠culos</a>
                        <a href="#condutor" class="text-slate-600 hover:bg-slate-100 hover:text-slate-900 px-3 py-2 rounded-md text-sm font-medium">O Condutor</a>
                        <a href="#processos" class="text-slate-600 hover:bg-slate-100 hover:text-slate-900 px-3 py-2 rounded-md text-sm font-medium">Processos</a>
                        <a href="#assistente" class="text-slate-600 hover:bg-slate-100 hover:text-slate-900 px-3 py-2 rounded-md text-sm font-medium">Assistente ‚ú®</a>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">

        <section id="visao-geral" class="mb-16 scroll-mt-20">
            <h2 class="text-3xl font-bold text-slate-900 mb-4">Uso da Frota Oficial: Vis√£o Geral</h2>
            <p class="text-slate-600 mb-8 max-w-3xl text-justify">
                Esta se√ß√£o apresenta o prop√≥sito da Instru√ß√£o Normativa 08/2025 e os princ√≠pios fundamentais que todos os servidores devem seguir. O objetivo √© garantir que o uso dos ve√≠culos p√∫blicos seja feito de forma padronizada, eficiente e estritamente para fins institucionais, assegurando a correta gest√£o do patrim√¥nio do DER-DF.
            </p>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                    <h3 class="font-semibold text-slate-900 mb-2">üéØ Prop√≥sito da Norma</h3>
                    <p class="text-sm text-slate-600 text-justify">Disciplinar, padronizar e garantir o uso eficiente e seguro de toda a frota oficial do DER-DF, incluindo ve√≠culos, m√°quinas e equipamentos.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                    <h3 class="font-semibold text-slate-900 mb-2">üè¢ Uso Exclusivo Institucional</h3>
                    <p class="text-sm text-slate-600 text-justify">A utiliza√ß√£o dos ve√≠culos √© restrita a atividades de servi√ßo e ao desempenho de fun√ß√µes oficiais. Qualquer uso para fins particulares √© estritamente proibido.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                    <h3 class="font-semibold text-slate-900 mb-2">‚úçÔ∏è Autoriza√ß√£o e Registro</h3>
                    <p class="text-sm text-slate-600 text-justify">Toda utiliza√ß√£o exige solicita√ß√£o formal pr√©via e aprova√ß√£o. Al√©m disso, todos os deslocamentos devem ser devidamente registrados em sistema de controle.</p>
                </div>
            </div>
        </section>

        <hr class="my-16 border-slate-200">

        <section id="regras-essenciais" class="mb-16 scroll-mt-20">
            <h2 class="text-3xl font-bold text-slate-900 mb-4">Regras Essenciais: Deveres e Proibi√ß√µes</h2>
             <p class="text-slate-600 mb-8 max-w-3xl text-justify">
                Para facilitar a consulta r√°pida, esta se√ß√£o resume as responsabilidades e as restri√ß√µes mais importantes para o condutor. Use os bot√µes abaixo para alternar entre a lista de deveres obrigat√≥rios e a lista de a√ß√µes que s√£o expressamente proibidas ao utilizar um ve√≠culo oficial.
            </p>
            <div class="flex space-x-4 mb-8">
                <button id="btn-deveres" class="bg-amber-500 text-white px-6 py-2 rounded-md font-semibold shadow-sm hover:bg-amber-600 transition-colors">Deveres do Condutor</button>
                <button id="btn-proibicoes" class="bg-slate-200 text-slate-700 px-6 py-2 rounded-md font-semibold hover:bg-slate-300 transition-colors">Proibi√ß√µes</button>
            </div>

            <div id="content-deveres" class="grid md:grid-cols-2 gap-4">
                <div class="bg-white p-4 rounded-lg flex items-start space-x-3"><span class="text-green-500 font-bold text-xl">‚úì</span><p class="text-sm text-justify">Manter o ve√≠culo limpo e conservado.</p></div>
                <div class="bg-white p-4 rounded-lg flex items-start space-x-3"><span class="text-green-500 font-bold text-xl">‚úì</span><p class="text-sm text-justify">Verificar diariamente n√≠veis de √≥leo, √°gua, pneus e freios.</p></div>
                <div class="bg-white p-4 rounded-lg flex items-start space-x-3"><span class="text-green-500 font-bold text-xl">‚úì</span><p class="text-sm text-justify">Comunicar imediatamente qualquer problema √† Ger√™ncia de Transporte.</p></div>
                <div class="bg-white p-4 rounded-lg flex items-start space-x-3"><span class="text-green-500 font-bold text-xl">‚úì</span><p class="text-sm text-justify">Em caso de sinistro, solicitar per√≠cia policial.</p></div>
                <div class="bg-white p-4 rounded-lg flex items-start space-x-3"><span class="text-green-500 font-bold text-xl">‚úì</span><p class="text-sm text-justify">Usar cinto de seguran√ßa e exigir que os passageiros usem.</p></div>
                <div class="bg-white p-4 rounded-lg flex items-start space-x-3"><span class="text-green-500 font-bold text-xl">‚úì</span><p class="text-sm text-justify">Preencher a Guia de Autoriza√ß√£o e Movimenta√ß√£o de Ve√≠culos.</p></div>
            </div>

            <div id="content-proibicoes" class="hidden grid md:grid-cols-2 gap-4">
                <div class="bg-white p-4 rounded-lg flex items-start space-x-3"><span class="text-red-500 font-bold text-xl">‚úó</span><p class="text-sm text-justify">Usar o ve√≠culo para fins particulares (supermercados, clubes, resid√™ncias).</p></div>
                <div class="bg-white p-4 rounded-lg flex items-start space-x-3"><span class="text-red-500 font-bold text-xl">‚úó</span><p class="text-sm text-justify">Transportar familiares ou pessoas estranhas ao servi√ßo.</p></div>
                <div class="bg-white p-4 rounded-lg flex items-start space-x-3"><span class="text-red-500 font-bold text-xl">‚úó</span><p class="text-sm text-justify">Ceder a dire√ß√£o do ve√≠culo a terceiros n√£o autorizados.</p></div>
                <div class="bg-white p-4 rounded-lg flex items-start space-x-3"><span class="text-red-500 font-bold text-xl">‚úó</span><p class="text-sm text-justify">Conduzir sob efeito de √°lcool ou subst√¢ncias psicoativas.</p></div>
                <div class="bg-white p-4 rounded-lg flex items-start space-x-3"><span class="text-red-500 font-bold text-xl">‚úó</span><p class="text-sm text-justify">Recolher ve√≠culos de servi√ßo em garagem residencial.</p></div>
                <div class="bg-white p-4 rounded-lg flex items-start space-x-3"><span class="text-red-500 font-bold text-xl">‚úó</span><p class="text-sm text-justify">Conduzir com trajes inadequados (bermudas, chinelos, camisa sem mangas).</p></div>
            </div>
        </section>

        <hr class="my-16 border-slate-200">

        <section id="veiculos" class="mb-16 scroll-mt-20">
            <h2 class="text-3xl font-bold text-slate-900 mb-4">Categorias de Ve√≠culos e Regras</h2>
            <p class="text-slate-600 mb-8 max-w-3xl text-justify">
                A frota do DER-DF √© classificada em tr√™s categorias principais, cada uma com regras de uso, identifica√ß√£o e recolhimento espec√≠ficas. Navegue pelas abas para conhecer as particularidades de cada tipo de ve√≠culo e os crit√©rios para sua baixa e aliena√ß√£o.
            </p>
            <div class="mb-8">
                <div class="border-b border-slate-200">
                    <nav class="-mb-px flex space-x-6" aria-label="Tabs">
                        <button class="tab-btn border-amber-500 text-amber-600 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm" data-tab="representacao">Representa√ß√£o</button>
                        <button class="tab-btn border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm" data-tab="institucional">Transporte Institucional</button>
                        <button class="tab-btn border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm" data-tab="servico">Servi√ßo</button>
                    </nav>
                </div>
            </div>
            <div id="tab-content" class="bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                <!-- Content will be injected by JS -->
            </div>
        </section>

        <hr class="my-16 border-slate-200">

        <section id="condutor" class="mb-16 scroll-mt-20">
            <h2 class="text-3xl font-bold text-slate-900 mb-4">O Condutor: Autoriza√ß√£o e Responsabilidades</h2>
            <p class="text-slate-600 mb-8 max-w-3xl text-justify">
                Tornar-se um condutor autorizado da frota do DER-DF envolve um processo formal e acarreta responsabilidades diretas. Esta se√ß√£o detalha o passo a passo para obter a autoriza√ß√£o e esclarece a responsabilidade do condutor em casos de infra√ß√µes de tr√¢nsito ou sinistros.
            </p>
            <div class="grid lg:grid-cols-2 gap-12">
                <div>
                    <h3 class="text-xl font-semibold mb-6">Processo de Autoriza√ß√£o</h3>
                    <div class="relative pl-8">
                        <div class="absolute left-4 top-4 bottom-4 w-0.5 bg-slate-200"></div>
                        <div class="relative mb-8">
                            <div class="absolute left-[-18px] top-1 w-5 h-5 bg-amber-500 rounded-full border-4 border-white"></div>
                            <h4 class="font-semibold">Passo 1: Formul√°rios</h4>
                            <p class="text-sm text-slate-600 text-justify">Preenchimento da Ficha de Cadastro (Anexo I) e do Termo de Responsabilidade (Anexo II).</p>
                        </div>
                        <div class="relative mb-8">
                            <div class="absolute left-[-18px] top-1 w-5 h-5 bg-amber-500 rounded-full border-4 border-white"></div>
                            <h4 class="font-semibold">Passo 2: Assinatura</h4>
                            <p class="text-sm text-slate-600 text-justify">Obten√ß√£o da assinatura da Chefia Imediata ou do gestor do contrato.</p>
                        </div>
                        <div class="relative mb-8">
                            <div class="absolute left-[-18px] top-1 w-5 h-5 bg-amber-500 rounded-full border-4 border-white"></div>
                            <h4 class="font-semibold">Passo 3: Documenta√ß√£o</h4>
                            <p class="text-sm text-slate-600 text-justify">Apresenta√ß√£o de c√≥pia da CNH v√°lida.</p>
                        </div>
                        <div class="relative">
                            <div class="absolute left-[-18px] top-1 w-5 h-5 bg-amber-500 rounded-full border-4 border-white"></div>
                            <h4 class="font-semibold">Passo 4: An√°lise Final</h4>
                            <p class="text-sm text-slate-600 text-justify">Encaminhamento para an√°lise e autoriza√ß√£o da Superintend√™ncia de Opera√ß√µes.</p>
                        </div>
                    </div>
                </div>
                <div>
                    <h3 class="text-xl font-semibold mb-6">Infra√ß√µes e Sinistros</h3>
                    <div class="space-y-6">
                        <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                            <h4 class="font-semibold text-slate-900 mb-2">Infra√ß√µes de Tr√¢nsito</h4>
                            <p class="text-sm text-slate-600 text-justify">O condutor √© o √∫nico respons√°vel pelo pagamento de multas decorrentes de infra√ß√µes cometidas. A n√£o regulariza√ß√£o pode levar √† apura√ß√£o de responsabilidade administrativa.</p>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                            <h4 class="font-semibold text-slate-900 mb-2">Em Caso de Sinistro</h4>
                            <p class="text-sm text-slate-600 text-justify">O condutor poder√° ser responsabilizado pelos custos de reparo se o sinistro for causado por imper√≠cia, imprud√™ncia ou mau uso comprovado do ve√≠culo.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <hr class="my-16 border-slate-200">

        <section id="processos" class="mb-16 scroll-mt-20">
            <h2 class="text-3xl font-bold text-slate-900 mb-4">Processos: Abastecimento e Manuten√ß√£o</h2>
            <p class="text-slate-600 mb-8 max-w-3xl text-justify">
                O correto abastecimento e a manuten√ß√£o preventiva s√£o fundamentais para a longevidade e seguran√ßa da frota. Aqui voc√™ encontra as regras sobre as cotas de combust√≠vel, o procedimento de abastecimento e a responsabilidade pela manuten√ß√£o dos ve√≠culos.
            </p>
            <div class="grid lg:grid-cols-2 gap-12 items-center">
                <div>
                    <h3 class="text-xl font-semibold mb-6">Cotas Mensais de Combust√≠vel (Ve√≠culos M√©dios)</h3>
                    <div class="chart-container">
                        <canvas id="fuelChart"></canvas>
                    </div>
                    <p class="text-xs text-center text-slate-500 mt-2">Cotas extras devem ser solicitadas √† Superintend√™ncia de Opera√ß√µes. Ve√≠culos de representa√ß√£o e guinchos s√£o exce√ß√µes.</p>
                </div>
                <div class="space-y-6">
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                        <h4 class="font-semibold text-slate-900 mb-2">Procedimento de Abastecimento</h4>
                        <p class="text-sm text-slate-600 text-justify">O abastecimento √© feito com cart√£o magn√©tico em postos credenciados. √â obrigat√≥rio informar placa, quilometragem, c√≥digo e senha. Os dados s√£o pessoais e intransfer√≠veis.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                        <h4 class="font-semibold text-slate-900 mb-2">Manuten√ß√£o Preventiva</h4>
                        <p class="text-sm text-slate-600 text-justify">A unidade de lota√ß√£o do ve√≠culo √© respons√°vel por encaminh√°-lo para as revis√µes na Diretoria de Manuten√ß√£o, respeitando os prazos de quilometragem ou tempo.</p>
                    </div>
                </div>
            </div>
        </section>

        <hr class="my-16 border-slate-200">

        <section id="assistente" class="mb-16 scroll-mt-20">
            <h2 class="text-3xl font-bold text-slate-900 mb-4">Assistente de Cen√°rios ‚ú®</h2>
            <p class="text-slate-600 mb-8 max-w-3xl text-justify">
                Descreva uma situa√ß√£o ou fa√ßa uma pergunta sobre as regras da frota. O assistente de IA ir√° analisar o contexto da Instru√ß√£o Normativa e fornecer a melhor orienta√ß√£o poss√≠vel.
            </p>
            <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                <textarea id="scenario-input" rows="4" class="w-full p-3 rounded-md border border-slate-300 focus:outline-none focus:ring-2 focus:ring-amber-500 text-sm" placeholder="Ex: 'O que devo fazer em caso de um acidente durante o hor√°rio de servi√ßo?'"></textarea>
                <div class="mt-4 flex justify-end items-center">
                    <div id="loading-indicator" class="hidden flex items-center text-slate-500 text-sm">
                        <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-slate-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                        Analisando...
                    </div>
                    <button id="send-scenario-btn" class="bg-amber-500 text-white px-6 py-2 rounded-md font-semibold shadow-sm hover:bg-amber-600 transition-colors">Obter Orienta√ß√£o ‚ú®</button>
                </div>
                <div id="scenario-output" class="mt-6 p-4 rounded-md bg-slate-50 border border-slate-200 text-slate-700 hidden"></div>
            </div>
        </section>

    </main>

    <footer class="bg-slate-800 text-white">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 text-center">
            <p class="font-semibold mb-2">√â obriga√ß√£o de todo servidor conhecer e cumprir esta norma.</p>
            <p class="text-sm text-slate-300">O descumprimento pode resultar em san√ß√µes disciplinares.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const btnDeveres = document.getElementById('btn-deveres');
            const btnProibicoes = document.getElementById('btn-proibicoes');
            const contentDeveres = document.getElementById('content-deveres');
            const contentProibicoes = document.getElementById('content-proibicoes');
            const tabButtons = document.querySelectorAll('.tab-btn');
            const tabContentContainer = document.getElementById('tab-content');
            const scenarioInput = document.getElementById('scenario-input');
            const sendScenarioBtn = document.getElementById('send-scenario-btn');
            const scenarioOutput = document.getElementById('scenario-output');
            const loadingIndicator = document.getElementById('loading-indicator');

            btnDeveres.addEventListener('click', () => {
                contentDeveres.classList.remove('hidden');
                contentProibicoes.classList.add('hidden');
                btnDeveres.classList.add('bg-amber-500', 'text-white');
                btnDeveres.classList.remove('bg-slate-200', 'text-slate-700');
                btnProibicoes.classList.add('bg-slate-200', 'text-slate-700');
                btnProibicoes.classList.remove('bg-amber-500', 'text-white');
            });

            btnProibicoes.addEventListener('click', () => {
                contentProibicoes.classList.remove('hidden');
                contentDeveres.classList.add('hidden');
                btnProibicoes.classList.add('bg-amber-500', 'text-white');
                btnProibicoes.classList.remove('bg-slate-200', 'text-slate-700');
                btnDeveres.classList.add('bg-slate-200', 'text-slate-700');
                btnDeveres.classList.remove('bg-amber-500', 'text-white');
            });

            const tabData = {
                representacao: {
                    title: 'I. Ve√≠culos de Representa√ß√£o',
                    content: `
                        <p class="mb-4 text-slate-600 text-justify"><strong>Uso:</strong> Restrito ao Presidente, titulares da Diretoria Colegiada e assessoria de intelig√™ncia.</p>
                        <ul class="list-disc pl-5 space-y-2 text-slate-600 text-justify">
                            <li>Podem ter identifica√ß√£o visual dispensada.</li>
                            <li>Possuem exce√ß√£o √† regra de recolhimento di√°rio nas unidades do DER-DF.</li>
                            <li>N√£o se aplicam os limites de cotas mensais de combust√≠vel a esta categoria.</li>
                        </ul>
                    `
                },
                institucional: {
                    title: 'II. Ve√≠culos de Transporte Institucional',
                    content: `
                        <p class="mb-4 text-slate-600 text-justify"><strong>Uso:</strong> Destinados a atividades de Fiscaliza√ß√£o de Tr√¢nsito, Fiscaliza√ß√£o de Faixas de Dom√≠nio, opera√ß√£o e educa√ß√£o de tr√¢nsito.</p>
                        <ul class="list-disc pl-5 space-y-2 text-slate-600 text-justify">
                            <li>Devem ser obrigatoriamente identificados visualmente com adesivos (Anexo III).</li>
                            <li>Viaturas de fiscaliza√ß√£o e guinchos devem ser abastecidas ap√≥s cada plant√£o.</li>
                            <li>Caminh√µes guinchos n√£o est√£o sujeitos aos limites de cotas mensais de combust√≠vel.</li>
                        </ul>
                    `
                },
                servico: {
                    title: 'III. Ve√≠culos de Servi√ßo',
                    content: `
                        <p class="mb-4 text-slate-600 text-justify"><strong>Uso:</strong> Para transporte de materiais, equipamentos, insumos, bens m√≥veis e transporte de pessoal exclusivamente em servi√ßo p√∫blico.</p>
                        <ul class="list-disc pl-5 space-y-2 text-slate-600 text-justify">
                            <li>Ser√£o utilizados de modo compartilhado entre os setores.</li>
                            <li>Devem ser obrigatoriamente identificados visualmente (se da frota pr√≥pria ou locados).</li>
                            <li>Devem ser recolhidos diariamente na unidade de lota√ß√£o, sendo proibido o pernoite em resid√™ncias.</li>
                        </ul>
                        <div class="mt-6 pt-4 border-t border-slate-200">
                           <h4 class="font-semibold text-slate-900 mb-2">Crit√©rios para Baixa da Frota</h4>
                           <div class="grid sm:grid-cols-2 gap-4 text-center">
                               <div class="bg-slate-50 p-4 rounded-lg">
                                   <p class="text-sm text-slate-500">Quilometragem</p>
                                   <p class="text-2xl font-bold text-slate-800">300.000 km</p>
                                   <p class="text-xs text-slate-500">(Ve√≠culos 4+ rodas)</p>
                               </div>
                               <div class="bg-slate-50 p-4 rounded-lg">
                                   <p class="text-sm text-slate-500">Tempo de Uso</p>
                                   <p class="text-2xl font-bold text-slate-800">10-12 anos</p>
                                   <p class="text-xs text-slate-500">(Gasolina/Diesel)</p>
                               </div>
                           </div>
                        </div>
                    `
                }
            };

            function updateTabContent(tabKey) {
                const data = tabData[tabKey];
                tabContentContainer.innerHTML = `<h3 class="text-xl font-semibold mb-4">${data.title}</h3>${data.content}`;
            }

            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    tabButtons.forEach(btn => {
                        btn.classList.remove('border-amber-500', 'text-amber-600');
                        btn.classList.add('border-transparent', 'text-slate-500', 'hover:text-slate-700', 'hover:border-slate-300');
                    });
                    button.classList.add('border-amber-500', 'text-amber-600');
                    button.classList.remove('border-transparent', 'text-slate-500', 'hover:text-slate-700', 'hover:border-slate-300');
                    updateTabContent(button.dataset.tab);
                });
            });

            updateTabContent('representacao');

            const ctx = document.getElementById('fuelChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Gasolina', 'Etanol', '√ìleo Diesel'],
                    datasets: [{
                        label: 'Cota Mensal (Litros)',
                        data: [240, 260, 300],
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.7)',
                            'rgba(16, 185, 129, 0.7)',
                            'rgba(245, 158, 11, 0.7)'
                        ],
                        borderColor: [
                            'rgba(59, 130, 246, 1)',
                            'rgba(16, 185, 129, 1)',
                            'rgba(245, 158, 11, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: '#1e293b',
                            titleFont: { size: 14 },
                            bodyFont: { size: 12 },
                            padding: 10,
                            cornerRadius: 4
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            grid: {
                                color: '#e2e8f0'
                            },
                            ticks: {
                                color: '#475569'
                            }
                        },
                        y: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: '#334155'
                            }
                        }
                    }
                }
            });

            // Gemini API Integration - Refactored with a different model for improved stability.
            const documentContent = `
            Instru√ß√£o Normativa N¬∫ 08/2025 - DER-DF.
            Vis√£o Geral (ID:visao-geral): Prop√≥sito √© disciplinar o uso da frota para fins institucionais. O uso √© exclusivo para atividades de servi√ßo. Toda utiliza√ß√£o exige autoriza√ß√£o e registro.
            Regras Essenciais (ID:regras-essenciais):
            Deveres: Manter ve√≠culo limpo, verificar n√≠veis, comunicar problemas, solicitar per√≠cia em sinistro, usar cinto, preencher guia de autoriza√ß√£o.
            Proibi√ß√µes: Usar para fins particulares, transportar familiares, ceder a dire√ß√£o, conduzir embriagado, recolher ve√≠culo em garagem residencial, dirigir com trajes inadequados.
            Ve√≠culos (ID:veiculos):
            I. Ve√≠culos de Representa√ß√£o: Uso restrito √† Diretoria. Identifica√ß√£o visual dispensada. N√£o precisam recolher diariamente. N√£o tem cota de combust√≠vel.
            II. Ve√≠culos de Transporte Institucional: Uso em fiscaliza√ß√£o e opera√ß√µes. Identifica√ß√£o obrigat√≥ria. Abastecimento ap√≥s plant√£o (viaturas/guinchos). Guinchos n√£o t√™m cota.
            III. Ve√≠culos de Servi√ßo: Uso compartilhado para transporte de materiais e pessoal em servi√ßo. Identifica√ß√£o obrigat√≥ria. Recolhimento di√°rio obrigat√≥rio em unidade do DER-DF. Crit√©rios de baixa: 300.000 km ou 10-12 anos de uso.
            Condutor (ID:condutor):
            Processo de Autoriza√ß√£o: 1. Preencher Anexo I e II; 2. Assinar com a chefia; 3. Apresentar CNH; 4. An√°lise pela Superintend√™ncia.
            Infra√ß√µes e Sinistros: Condutor respons√°vel por multas. Pode ser responsabilizado por custos de sinistro se for por mau uso/imprud√™ncia.
            Processos (ID:processos):
            Abastecimento: Cart√£o magn√©tico em postos credenciados, dados pessoais e intransfer√≠veis.
            Manuten√ß√£o: Unidade de lota√ß√£o do ve√≠culo √© respons√°vel por encaminh√°-lo para as revis√µes na Diretoria de Manuten√ß√£o, respeitando os prazos de quilometragem ou tempo.
            `;

            sendScenarioBtn.addEventListener('click', async () => {
                const prompt = scenarioInput.value.trim();
                if (!prompt) {
                    scenarioOutput.innerHTML = '<p class="text-red-500">Por favor, digite um cen√°rio ou uma pergunta.</p>';
                    scenarioOutput.classList.remove('hidden');
                    return;
                }

                scenarioOutput.classList.add('hidden');
                loadingIndicator.classList.remove('hidden');
                sendScenarioBtn.disabled = true;

                const fullPrompt = `Voc√™ √© um assistente de IA focado em fornecer orienta√ß√µes precisas com base no seguinte documento da Instru√ß√£o Normativa 08/2025 do DER-DF. Use apenas as informa√ß√µes fornecidas e n√£o adicione informa√ß√µes externas. Responda de forma clara, objetiva e em portugu√™s.

Documento de Refer√™ncia:
"""
${documentContent}
"""

Cen√°rio ou Pergunta do usu√°rio:
"""
${prompt}
"""

Responda apenas com a orienta√ß√£o baseada no documento.`;

                const callApiWithRetry = async (retries = 3, delay = 1000) => {
                    try {
                        const chatHistory = [{ role: "user", parts: [{ text: fullPrompt }] }];
                        const payload = { contents: chatHistory };
                        const apiKey = "";
                        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-preview-0514:generateContent?key=${apiKey}`; // Changed to a more stable model.

                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        if (!response.ok) {
                            throw new Error(`Erro na API: ${response.status} ${response.statusText}`);
                        }

                        const result = await response.json();
                        const text = result?.candidates?.[0]?.content?.parts?.[0]?.text;

                        if (text) {
                            scenarioOutput.innerHTML = `<p>${text}</p>`;
                            scenarioOutput.classList.remove('hidden');
                        } else {
                            scenarioOutput.innerHTML = '<p class="text-red-500">N√£o foi poss√≠vel obter uma resposta. Ocorreu um erro no formato da resposta da IA.</p>';
                            scenarioOutput.classList.remove('hidden');
                        }
                    } catch (error) {
                        console.error('Erro ao chamar a API:', error);
                        if (retries > 0) {
                            await new Promise(resolve => setTimeout(resolve, delay));
                            await callApiWithRetry(retries - 1, delay * 2);
                        } else {
                            throw error;
                        }
                    }
                };

                try {
                    await callApiWithRetry();
                } catch (finalError) {
                    scenarioOutput.innerHTML = `<p class="text-red-500">Ocorreu um erro grave e o servi√ßo de IA parece estar indispon√≠vel no momento. Por favor, tente novamente mais tarde.</p>`;
                    scenarioOutput.classList.remove('hidden');
                } finally {
                    loadingIndicator.classList.add('hidden');
                    sendScenarioBtn.disabled = false;
                }
            });
        });
    </script>
</body>
</html>
